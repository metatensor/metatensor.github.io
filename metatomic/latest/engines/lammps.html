<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="PLUMED" href="plumed.html"><link rel="prev" title="i-PI" href="ipi.html">
        <link rel="canonical" href="https://docs.metatensor.org/metatomic/latest/engines/lammps.html">
        <link rel="prefetch" href="../_static/images/metatomic-horizontal.png" as="image">
        <link rel="prefetch" href="../_static/images/metatomic-horizontal-dark.png" as="image">

    <link rel="shortcut icon" href="../_static/metatomic-64.png"><!-- Generated with Sphinx 7.4.7 and Furo 2025.09.25 -->
        <title>LAMMPS - Metatomic</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/css/metatomic.css?v=ca173047" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Metatomic</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/images/metatomic-horizontal.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/images/metatomic-horizontal-dark.png" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../torch/index.html">TorchScript backend</a><input aria-label="Toggle navigation of TorchScript backend" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../torch/reference/index.html">API reference</a><input aria-label="Toggle navigation of API reference" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../torch/reference/systems.html">Systems</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../torch/reference/models/index.html">Models</a><input aria-label="Toggle navigation of Models" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../torch/reference/models/export.html">Exporting models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../torch/reference/models/metadata.html">Information about models</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../torch/reference/misc.html">Miscellaneous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../torch/reference/ase.html">Atomic Simulation Environment (ASE) integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../torch/reference/serialization.html">Serialization</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../torch/reference/cxx/index.html">C++ API reference</a><input aria-label="Toggle navigation of C++ API reference" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../torch/reference/cxx/systems.html">Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../torch/reference/cxx/models.html">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../torch/reference/cxx/misc.html">Miscellaneous</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../torch/CHANGELOG.html">Changelog</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../outputs/index.html">Standard model outputs</a><input aria-label="Toggle navigation of Standard model outputs" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../outputs/energy.html">Energy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outputs/non_conservative.html">Non-conservative forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outputs/non_conservative.html#non-conservative-stress">Non-conservative stress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outputs/positions-and-momenta.html">Positions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outputs/positions-and-momenta.html#momenta">Momenta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outputs/features.html">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outputs/variants.html">Output variants</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Simulation engines</a><input aria-label="Toggle navigation of Simulation engines" checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ase.html">ASE</a></li>
<li class="toctree-l2"><a class="reference internal" href="chemiscope.html">chemiscope</a></li>
<li class="toctree-l2"><a class="reference internal" href="eon.html">eOn</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipi.html">i-PI</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">LAMMPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="plumed.html">PLUMED</a></li>
<li class="toctree-l2"><a class="reference internal" href="torch-sim.html">torch-sim</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Tutorials</a><input aria-label="Toggle navigation of Tutorials" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/1-export-atomistic-model.html">Exporting a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/2-running-ase-md.html">Running Molecular Dynamics with ASE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/3-atomistic-model-with-nl.html">Creating models that use neighbor lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/4-profiling.html">Profiling your models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing Metatomic</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/engines/lammps.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="lammps">
<span id="engine-lammps"></span><h1>LAMMPS<a class="headerlink" href="#lammps" title="Link to this heading">¶</a></h1>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Official website</p></th>
<th class="head"><p>How is metatomic supported?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://lammps.org">https://lammps.org</a></p></td>
<td><p>In a separate <a class="reference external" href="https://github.com/metatensor/lammps">fork</a></p></td>
</tr>
</tbody>
</table>
</div>
<section id="supported-model-outputs">
<h2>Supported model outputs<a class="headerlink" href="#supported-model-outputs" title="Link to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../outputs/energy.html#energy-output"><span class="std std-ref">energy</span></a>, non-conservative <a class="reference internal" href="../outputs/non_conservative.html#non-conservative-forces-output"><span class="std std-ref">forces</span></a> and <a class="reference internal" href="../outputs/non_conservative.html#non-conservative-stress-output"><span class="std std-ref">stress</span></a>
outputs are supported in LAMMPS, as a custom <code class="docutils literal notranslate"><span class="pre">pair_style</span></code>. This allows running
molecular dynamics simulations with interatomic potentials in the metatomic format;
distributing the simulation over multiple nodes and potentially multiple GPUs.</p>
</section>
<section id="how-to-install-the-code">
<h2>How to install the code<a class="headerlink" href="#how-to-install-the-code" title="Link to this heading">¶</a></h2>
<section id="getting-a-pre-built-binary-with-conda">
<h3>Getting a pre-built binary with <code class="docutils literal notranslate"><span class="pre">conda</span></code><a class="headerlink" href="#getting-a-pre-built-binary-with-conda" title="Link to this heading">¶</a></h3>
<p>The easiest way to install a version of <code class="docutils literal notranslate"><span class="pre">lammps</span></code> which can use metatomic
models is to use the build we provide through conda. We recommend that you use
<a class="reference external" href="https://github.com/conda-forge/miniforge">miniforge</a> as your conda provider.</p>
<p>First you’ll need to pick an MPI implementation, from <code class="docutils literal notranslate"><span class="pre">openmpi</span></code>, <code class="docutils literal notranslate"><span class="pre">mpich</span></code> or
<code class="docutils literal notranslate"><span class="pre">nompi</span></code> (which does not have MPI enabled). If you’d like to use the MPI
library from your system (for example when running on supercomputers with
specific MPI tuning), please follow these instructions:
<a class="reference external" href="https://conda-forge.org/docs/user/tipsandtricks/#using-external-message-passing-interface-mpi-libraries">https://conda-forge.org/docs/user/tipsandtricks/#using-external-message-passing-interface-mpi-libraries</a></p>
<p>You can then install LAMMPS with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># for example with nompi</span>
conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>metatensor<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span><span class="s2">&quot;lammps-metatomic=*=*nompi*&quot;</span>

<span class="c1"># or with openmpi</span>
conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>metatensor<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span><span class="s2">&quot;lammps-metatomic=*=*openmpi*&quot;</span>
</pre></div>
</div>
<p>This version of LAMMPS will be able to run the models on CPU or GPU, but will
run the time integration of the trajectory on CPU. If you also want to run the
time integration on GPU, you’ll need to install the <a class="reference external" href="https://docs.lammps.org/Speed_kokkos.html">kokkos-enabled</a> build of
LAMMPS. This build currently only exists for CUDA GPUs, and each build only
supports a single GPU architecture.</p>
<p>To get the correct KOKKOS build for your GPU, you’ll first need to determine its
compute capability. For this, you can run the following command with a GPU
present (i.e. on the compute node of supercomputers):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nvidia-smi<span class="w"> </span>--query-gpu<span class="o">=</span>compute_cap<span class="w"> </span>--format<span class="o">=</span>csv,noheader
</pre></div>
</div>
<p>Alternatively, you can also get the compute capability from <a class="reference external" href="https://developer.nvidia.com/cuda-gpus">NVIDIA’s
documentation</a></p>
<p>We currenly build the code for the following compute capabilities:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">VOLTA70</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AMPERE80</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AMPERE86</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ADA89</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HOPPER90</span></code></p></li>
</ul>
<p>For example, if you have a <strong>NVIDIA A100 GPU</strong>, it’s compute capability is
<code class="docutils literal notranslate"><span class="pre">8.0</span></code> (i.e. <code class="docutils literal notranslate"><span class="pre">AMPERE80</span></code>).</p>
<p>Now that you know the compute capability, you can install the correct kokkos
build (here as well, you can pick between different MPI implementations).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>metatensor<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span><span class="s2">&quot;lammps-metatomic=*=cuda*AMPERE80*nompi*&quot;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be aware that some HPC clusters may be set up without NVIDIA drivers
installed on the head/login node. This will result in conda not detecting
the system configuration of the compute nodes (which probably have GPUs if
you are in this section) and will not install correct torch and cuda
libraries. To fix it, you should run the install from a GPU node (check that
after running <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">info</span></code> on the node your installing from, if <code class="docutils literal notranslate"><span class="pre">__cuda</span></code> is
in the <code class="docutils literal notranslate"><span class="pre">virtual</span> <span class="pre">packages</span></code> section).</p>
<p>You can also trick conda into installing cuda enabled versions on a
login node without NVIDIA drivers, by setting the environment variable
<code class="docutils literal notranslate"><span class="pre">CONDA_OVERRIDE_CUDA</span></code> to the correct CUDA version:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CONDA_OVERRIDE_CUDA</span><span class="o">=</span><span class="m">12</span>.4<span class="w"> </span>conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>metatensor<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span><span class="s2">&quot;lammps-metatomic=*=cuda*AMPERE80*nompi*&quot;</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you get the following error</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Kokkos</span><span class="p">::</span><span class="n">Cuda</span><span class="p">::</span><span class="n">initialize</span> <span class="n">ERROR</span><span class="p">:</span> <span class="n">likely</span> <span class="n">mismatch</span> <span class="n">of</span> <span class="n">architecture</span>
</pre></div>
</div>
<p>you are likely using the wrong KOKKOS build. Please double check that the
compute capabilities of your GPU match the build you used.</p>
</div>
</section>
<section id="building-from-sources">
<h3>Building from sources<a class="headerlink" href="#building-from-sources" title="Link to this heading">¶</a></h3>
<p>The code is available in a custom fork of LAMMPS, and you can get it with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/metatensor/lammps<span class="w"> </span>lammps-metatomic
<span class="nb">cd</span><span class="w"> </span>lammps-metatomic
</pre></div>
</div>
<p>You’ll need to provide some of the code dependencies yourself. There are
multiple ways to go about it, here we detail a fully manual installation, an
installation using <code class="docutils literal notranslate"><span class="pre">conda</span></code> and an installation using <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<section id="option-1-dependencies-from-conda">
<h4>Option 1: dependencies from <code class="docutils literal notranslate"><span class="pre">conda</span></code><a class="headerlink" href="#option-1-dependencies-from-conda" title="Link to this heading">¶</a></h4>
<p>All the dependencies of the code are available on <code class="docutils literal notranslate"><span class="pre">conda</span></code>, you can install
them with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># create an environment (you can also re-use an existing one)</span>
conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>lammps-metatomic
conda<span class="w"> </span>activate<span class="w"> </span>lammps-metatomic

conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>metatensor<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>libmetatomic-torch

<span class="c1"># Store this information to configure cmake down the line</span>
<span class="nv">CMAKE_PREFIX_PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$CONDA_PREFIX</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="option-2-dependencies-from-pip">
<h4>Option 2: dependencies from <code class="docutils literal notranslate"><span class="pre">pip</span></code><a class="headerlink" href="#option-2-dependencies-from-pip" title="Link to this heading">¶</a></h4>
<p>All the dependencies of the code are also available on <code class="docutils literal notranslate"><span class="pre">PyPI</span></code>, you can install
them with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># (optional) create an environment with your preferred method</span>
...

python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>metatomic-torch

<span class="c1"># on linux, if you don&#39;t have a GPU available, you should force the use of</span>
<span class="c1"># CPU-only torch instead</span>
python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--extra-index-url<span class="o">=</span>https://download.pytorch.org/whl/cpu<span class="w"> </span>metatomic-torch

<span class="c1"># Get the information to configure cmake down the line</span>
<span class="nv">TORCH_PREFIX</span><span class="o">=</span><span class="k">$(</span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import torch; print(torch.utils.cmake_prefix_path)&quot;</span><span class="k">)</span>
<span class="nv">MTS_PREFIX</span><span class="o">=</span><span class="k">$(</span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import metatensor; print(metatensor.utils.cmake_prefix_path)&quot;</span><span class="k">)</span>
<span class="nv">MTS_TORCH_PREFIX</span><span class="o">=</span><span class="k">$(</span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import metatensor.torch; print(metatensor.torch.utils.cmake_prefix_path)&quot;</span><span class="k">)</span>
<span class="nv">MTA_TORCH_PREFIX</span><span class="o">=</span><span class="k">$(</span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import metatomic.torch; print(metatomic.torch.utils.cmake_prefix_path)&quot;</span><span class="k">)</span>

<span class="nv">CMAKE_PREFIX_PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$TORCH_PREFIX</span><span class="s2">;</span><span class="nv">$MTS_PREFIX</span><span class="s2">;</span><span class="nv">$MTS_TORCH_PREFIX</span><span class="s2">;</span><span class="nv">$MTA_TORCH_PREFIX</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="option-3-manual-dependencies">
<h4>Option 3: manual dependencies<a class="headerlink" href="#option-3-manual-dependencies" title="Link to this heading">¶</a></h4>
<p>You’ll need to build or download the the C++ version of <code class="docutils literal notranslate"><span class="pre">libtorch</span></code>. You can
download it from <a class="reference external" href="https://pytorch.org/get-started/locally/">https://pytorch.org/get-started/locally/</a>, using the C++
language selector. Once you have it downloaded, extract the archive somewhere,
and record the path:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># point this to the path where you extracted the C++ libtorch</span>
<span class="nv">TORCH_PREFIX</span><span class="o">=</span>&lt;path/to/torch/installation&gt;
</pre></div>
</div>
<p>For the other dependencies, you’ll either need to install them yourself
following the links below, or let <code class="docutils literal notranslate"><span class="pre">cmake</span></code> download and build the latest
compatible versions:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.metatensor.org/latest/installation.html#install-c" title="(in metatensor)"><span class="xref std std-ref">metatensor</span></a></p></li>
<li><p><a class="reference external" href="https://docs.metatensor.org/latest/installation.html#install-torch-cxx" title="(in metatensor)"><span class="xref std std-ref">metatensor-torch</span></a></p></li>
<li><p><a class="reference internal" href="../installation.html#install-torch-cxx"><span class="std std-ref">metatomic-torch</span></a></p></li>
</ul>
<p>If you want to provide these yourself, you’ll need to also record the
corresponding installation paths:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">MTS_PREFIX</span><span class="o">=</span>&lt;path/to/metatensor/installation&gt;
<span class="nv">MTS_TORCH_PREFIX</span><span class="o">=</span>&lt;path/to/metatensor/torch/installation&gt;
<span class="nv">MTA_TORCH_PREFIX</span><span class="o">=</span>&lt;path/to/metatomic/torch/installation&gt;
</pre></div>
</div>
<p>And finally you can store this information to configure cmake down the line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CMAKE_PREFIX_PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$TORCH_PREFIX</span><span class="s2">;</span><span class="nv">$MTS_PREFIX</span><span class="s2">;</span><span class="nv">$MTS_TORCH_PREFIX</span><span class="s2">;</span><span class="nv">$MTA_TORCH_PREFIX</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="building-the-code">
<h4>Building the code<a class="headerlink" href="#building-the-code" title="Link to this heading">¶</a></h4>
<p>After installing the dependencies with one of the options above, you can
configure the build with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build

<span class="c1"># you can add more options here to enable other packages.</span>
cmake<span class="w"> </span>-DPKG_ML-METATOMIC<span class="o">=</span>ON<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-DLAMMPS_INSTALL_RPATH<span class="o">=</span>ON<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-DCMAKE_PREFIX_PATH<span class="o">=</span><span class="s2">&quot;</span><span class="nv">$CMAKE_PREFIX_PATH</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>../cmake

cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--parallel<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="c1"># or `make -jX`</span>

<span class="c1"># optionally install the code on your machine. You can also directly use</span>
<span class="c1"># the `lmp` binary in `lammps-metatomic/build/lmp` without installation</span>
cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span>install<span class="w"> </span><span class="c1"># or `make install`</span>
</pre></div>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">cmake</span></code> will try to find the <code class="docutils literal notranslate"><span class="pre">metatensor</span></code> and <code class="docutils literal notranslate"><span class="pre">metatomic</span></code>
libraries on your system and use them. If it can not find the libraries, it will
download and build them as part of the main LAMMPS build. You can control this
behavior by adding <code class="docutils literal notranslate"><span class="pre">-DDOWNLOAD_METATENSOR=ON</span></code> and <code class="docutils literal notranslate"><span class="pre">-DDOWNLOAD_METATOMIC=ON</span></code>
to the <code class="docutils literal notranslate"><span class="pre">cmake</span></code> options to always force a download; or prevent any download by
setting these options to <code class="docutils literal notranslate"><span class="pre">OFF</span></code>.</p>
<p>To enable KOKKOS and use a GPU for the time integration, you’ll need to add the
following flags to the <code class="docutils literal notranslate"><span class="pre">cmake</span></code> configuration, and then continue the build in the
same way as above.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cmake<span class="w"> </span><span class="o">[</span>other<span class="w"> </span>flags<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-DPKG_KOKKOS<span class="o">=</span>ON<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-DKokkos_ENABLE_CUDA<span class="o">=</span>ON<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-DKokkos_ENABLE_OPENMP<span class="o">=</span>ON<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-DKokkos_ARCH_&lt;ARCH&gt;<span class="o">=</span>ON<span class="w"> </span><span class="se">\ </span><span class="c1"># replace &lt;ARCH&gt; with the correct GPU architecture</span>
<span class="w">      </span>-DCMAKE_CXX_COMPILER<span class="o">=</span><span class="s2">&quot;</span><span class="nv">$PWD</span><span class="s2">/../lib/kokkos/bin/nvcc_wrapper&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>../cmake
</pre></div>
</div>
<p>See <a class="reference external" href="https://docs.lammps.org/Build_extras.html#kokkos">the main lammps documentation</a> to get more information
about configuring a kokkos build.</p>
</section>
</section>
</section>
<section id="how-to-use-the-code">
<h2>How to use the code<a class="headerlink" href="#how-to-use-the-code" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here we assume you already have an exported model that you want to use in
your simulations. Please see <a class="reference internal" href="../examples/1-export-atomistic-model.html#atomistic-tutorial-export"><span class="std std-ref">this tutorial</span></a> to learn how to manually create and export a
model; or use a tool like <a class="reference external" href="https://github.com/metatensor/metatrain">metatrain</a> to create a model based on existing
architectures and your own dataset.</p>
</div>
<p>After building and optionally installing the code, you can now use <code class="docutils literal notranslate"><span class="pre">pair_style</span>
<span class="pre">metatomic</span></code> in your LAMMPS input files! Below is the reference documentation
for this pair style, following a structure similar to the official LAMMPS
documentation.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pair_style<span class="w"> </span>metatomic<span class="w"> </span>model_path<span class="w"> </span>...<span class="w"> </span>keyword<span class="w"> </span>values<span class="w"> </span>...
</pre></div>
</div>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">model_path</span></code> = path to the file containing the exported metatomic model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keyword</span></code> = <strong>device</strong> or <strong>extensions</strong> or <strong>check_consistency</strong></p>
<pre class="literal-block"><strong>device</strong> values = device_name
  device_name = name of the Torch device to use for the calculations
<strong>extensions</strong> values = directory
  directory = path to a directory containing TorchScript extensions as
  shared libraries. If the model uses extensions, we will try to load
  them from this directory first
<strong>non_conservative</strong> values = on or off
  set this to on to use non-conservative forces and stresses in your
  simulation, typically affording a speedup factor between 2 and 3. We recommend
  using this in combination with RESPA to obtain physically correct
  observables (see <a class="reference external" href="https://arxiv.org/abs/2412.11569">https://arxiv.org/abs/2412.11569</a> for more information, and
  <a class="reference external" href="https://atomistic-cookbook.org/examples/pet-mad-nc/pet-mad-nc.html">https://atomistic-cookbook.org/examples/pet-mad-nc/pet-mad-nc.html</a> for an
  example of how to set up the RESPA run). Default to off.
<strong>scale</strong> values = float
  multiplies the contribution of the potential by a scaling factor.
  Defaults to 1.
<strong>check_consistency</strong> values = on or off
  set this to on/off to enable/disable internal consistency checks,
  verifying both the data passed by LAMMPS to the model, and the data
  returned by the model to LAMMPS.</pre>
</li>
</ul>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pair_style<span class="w"> </span>metatomic<span class="w"> </span>exported-model.pt<span class="w"> </span>device<span class="w"> </span>cuda<span class="w"> </span>extensions<span class="w"> </span>/home/user/torch-extensions/
pair_style<span class="w"> </span>metatomic<span class="w"> </span>soap-gap.pt<span class="w"> </span>check_consistency<span class="w"> </span>on
pair_coeff<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
</section>
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Link to this heading">¶</a></h3>
<p>Pair style <code class="docutils literal notranslate"><span class="pre">metatomic</span></code> provides access to models following <a class="reference external" href="https://docs.metatensor.org/latest/atomistic/index.html#atomistic-models" title="(in metatensor)"><span class="xref std std-ref">metatomic
models</span></a> interface; and enables using such models as
interatomic potentials to drive a LAMMPS simulation. The models can be fully
defined and trained by the user using Python code, or be existing pre-trained
models. The interface can be used with any type of machine learning model, as
long as the implementation of the model is compatible with TorchScript.</p>
<p>The only required argument for <code class="docutils literal notranslate"><span class="pre">pair_style</span> <span class="pre">metatomic</span></code> is the path to the model
file, which should be an exported metatomic model.</p>
<p>Optionally, users can define which torch <code class="docutils literal notranslate"><span class="pre">device</span></code> (e.g. cpu, cuda, cuda:0,
<em>etc.</em>) should be used to run the model. If this is not given, the code will run
on the best available device. If the model uses custom TorchScript operators
defined in a TorchScript extension, the shared library defining these extensions
will be searched in the <code class="docutils literal notranslate"><span class="pre">extensions</span></code> path, and loaded before trying to load
the model itself. Finally, <code class="docutils literal notranslate"><span class="pre">check_consistency</span></code> can be set to <code class="docutils literal notranslate"><span class="pre">on</span></code> or <code class="docutils literal notranslate"><span class="pre">off</span></code>
to enable (or disable) additional internal consistency checks in the
data being passed from LAMMPS to the model and back.</p>
<p>A single <code class="docutils literal notranslate"><span class="pre">pair_coeff</span></code> command should be used with the <code class="docutils literal notranslate"><span class="pre">metatomic</span></code> style,
specifying the mapping from LAMMPS types to the atomic types the model can
handle. The first 2 arguments must be * * so as to span all LAMMPS atom types.
This is followed by a list of N arguments that specify the mapping of
metatomic’s atomic types to LAMMPS types, where N is the number of LAMMPS atom
types.</p>
</section>
<section id="sample-input-file">
<h3>Sample input file<a class="headerlink" href="#sample-input-file" title="Link to this heading">¶</a></h3>
<p>Below is a example input file that creates an FCC crystal of Nickel, and use a
metatomic model to run NPT simulations. You can save this file to <code class="docutils literal notranslate"><span class="pre">input.in</span></code>
and run the simulation with <code class="docutils literal notranslate"><span class="pre">lmp</span> <span class="pre">-in</span> <span class="pre">input.in</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>units<span class="w"> </span>metal
boundary<span class="w"> </span>p<span class="w"> </span>p<span class="w"> </span>p

<span class="c1"># create the simulation system without reading external data file</span>
atom_style<span class="w"> </span>atomic
lattice<span class="w"> </span>fcc<span class="w"> </span><span class="m">3</span>.6
region<span class="w"> </span>box<span class="w"> </span>block<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">4</span>
create_box<span class="w"> </span><span class="m">1</span><span class="w"> </span>box
create_atoms<span class="w"> </span><span class="m">1</span><span class="w"> </span>box

labelmap<span class="w"> </span>atom<span class="w"> </span><span class="m">1</span><span class="w"> </span>Ni
mass<span class="w"> </span>Ni<span class="w"> </span><span class="m">58</span>.693

<span class="c1"># define the interaction style to use the model in the &quot;nickel-model.pt&quot; file</span>
pair_style<span class="w"> </span>metatomic<span class="w"> </span>nickel-model.pt<span class="w"> </span>device<span class="w"> </span>cuda
pair_coeff<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span><span class="m">28</span>

<span class="c1"># simulation settings</span>
timestep<span class="w"> </span><span class="m">0</span>.001<span class="w"> </span><span class="c1"># 1fs timestep</span>
fix<span class="w"> </span><span class="m">1</span><span class="w"> </span>all<span class="w"> </span>npt<span class="w"> </span>temp<span class="w"> </span><span class="m">243</span><span class="w"> </span><span class="m">243</span><span class="w"> </span><span class="k">$(</span><span class="m">100</span><span class="w"> </span>*<span class="w"> </span>dt<span class="k">)</span><span class="w"> </span>iso<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="k">$(</span><span class="m">1000</span><span class="w"> </span>*<span class="w"> </span>dt<span class="k">)</span><span class="w"> </span>drag<span class="w"> </span><span class="m">1</span>.0

<span class="c1"># output setup</span>
thermo<span class="w"> </span><span class="m">10</span>

<span class="c1"># run the simulation for 10000 steps</span>
run<span class="w"> </span><span class="m">10000</span>
</pre></div>
</div>
<p>Here is the same input file, using the KOKKOS version of the <code class="docutils literal notranslate"><span class="pre">pair_style</span></code>. You
can save this file to <code class="docutils literal notranslate"><span class="pre">input-kokkos.in</span></code>, and run it with <code class="docutils literal notranslate"><span class="pre">lmp</span> <span class="pre">-in</span>
<span class="pre">input-kokkos.in</span> <span class="pre">--suffix</span> <span class="pre">kk</span> <span class="pre">-k</span> <span class="pre">on</span> <span class="pre">g</span> <span class="pre">1</span></code>. See the <a class="reference external" href="https://docs.lammps.org/Speed_kokkos.html">lammps-kokkos</a> documentation
for more information about kokkos options.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>package<span class="w"> </span>kokkos<span class="w"> </span>newton<span class="w"> </span>on<span class="w"> </span>neigh<span class="w"> </span>half

units<span class="w"> </span>metal
boundary<span class="w"> </span>p<span class="w"> </span>p<span class="w"> </span>p

<span class="c1"># create the simulation system without reading external data file</span>
atom_style<span class="w"> </span>atomic/kk
lattice<span class="w"> </span>fcc<span class="w"> </span><span class="m">3</span>.6
region<span class="w"> </span>box<span class="w"> </span>block<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">4</span>
create_box<span class="w"> </span><span class="m">1</span><span class="w"> </span>box
create_atoms<span class="w"> </span><span class="m">1</span><span class="w"> </span>box

mass<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">58</span>.693

<span class="c1"># the model will automatically run on the same device as the kokkos code</span>
pair_style<span class="w"> </span>metatomic/kk<span class="w"> </span>nickel-model.pt
pair_coeff<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span><span class="m">28</span>

<span class="c1"># simulation settings</span>
timestep<span class="w"> </span><span class="m">0</span>.001<span class="w"> </span><span class="c1"># 1fs timestep</span>
fix<span class="w"> </span><span class="m">1</span><span class="w"> </span>all<span class="w"> </span>npt<span class="w"> </span>temp<span class="w"> </span><span class="m">243</span><span class="w"> </span><span class="m">243</span><span class="w"> </span><span class="k">$(</span><span class="m">100</span><span class="w"> </span>*<span class="w"> </span>dt<span class="k">)</span><span class="w"> </span>iso<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="k">$(</span><span class="m">1000</span><span class="w"> </span>*<span class="w"> </span>dt<span class="k">)</span><span class="w"> </span>drag<span class="w"> </span><span class="m">1</span>.0

<span class="c1"># output setup</span>
thermo<span class="w"> </span><span class="m">10</span>

run_style<span class="w"> </span>verlet/kk
<span class="c1"># run the simulation for 10000 steps</span>
run<span class="w"> </span><span class="m">10000</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="plumed.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">PLUMED</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="ipi.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">i-PI</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, the metatomic developers
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">LAMMPS</a><ul>
<li><a class="reference internal" href="#supported-model-outputs">Supported model outputs</a></li>
<li><a class="reference internal" href="#how-to-install-the-code">How to install the code</a><ul>
<li><a class="reference internal" href="#getting-a-pre-built-binary-with-conda">Getting a pre-built binary with <code class="docutils literal notranslate"><span class="pre">conda</span></code></a></li>
<li><a class="reference internal" href="#building-from-sources">Building from sources</a><ul>
<li><a class="reference internal" href="#option-1-dependencies-from-conda">Option 1: dependencies from <code class="docutils literal notranslate"><span class="pre">conda</span></code></a></li>
<li><a class="reference internal" href="#option-2-dependencies-from-pip">Option 2: dependencies from <code class="docutils literal notranslate"><span class="pre">pip</span></code></a></li>
<li><a class="reference internal" href="#option-3-manual-dependencies">Option 3: manual dependencies</a></li>
<li><a class="reference internal" href="#building-the-code">Building the code</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use-the-code">How to use the code</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#sample-input-file">Sample input file</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../_static/toggleprompt.js?v=5801b3bb"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/custom.js?v=4b1677b9"></script>
    <script data-domain="docs.metatensor.org" defer="defer" src="https://plausible.io/js/script.js"></script>
    </body>
</html>