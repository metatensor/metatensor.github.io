<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Python API reference" href="reference/python/index.html" /><link rel="prev" title="Core classes" href="index.html" />

    <link rel="shortcut icon" href="../_static/metatensor-64.png"/><!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Overview - Metatensor</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/css/metatensor.css?v=4d63172e" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Metatensor</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/images/metatensor-horizontal.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/images/metatensor-horizontal-dark.png" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../goals.html">Metatensor’s goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Core classes</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Core classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="reference/python/index.html">Python API reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Python API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="reference/python/tensor.html">TensorMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/python/block.html">TensorBlock</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/python/labels.html">Labels</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/python/io.html">Serialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/python/data.html">Data arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/python/misc.html">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="reference/cxx/index.html">C++ API reference</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of C++ API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="reference/cxx/tensor.html">TensorMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/cxx/labels.html">Labels</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/cxx/block.html">TensorBlock</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/cxx/data.html">Data arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/cxx/misc.html">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="reference/c/index.html">C API reference</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of C API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="reference/c/tensor.html">TensorMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/c/labels.html">Labels</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/c/block.html">TensorBlock</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/c/data.html">Data arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/c/misc.html">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reference/rust/index.html">Rust API reference</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../examples/core/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/core/1-first-steps.html">First steps with metatensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/core/2-handling-sparsity.html">Handling sparsity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/core/3-managing-gradients.html">Managing gradients</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="CHANGELOG.html">Changelog</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../operations/index.html">Operations</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Operations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../operations/torch.html">Operations and PyTorch</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../operations/reference/index.html">API reference</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../operations/reference/creation/index.html">Creation operations</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Creation operations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/creation/empty_like.html">empty_like()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/creation/ones_like.html">ones_like()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/creation/zeros_like.html">zeros_like()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/creation/random_like.html">random_like()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/creation/block_from_array.html">block_from_array()</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../operations/reference/linear_algebra/index.html">Linear algebra</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Linear algebra</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/linear_algebra/dot.html">dot()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/linear_algebra/lstsq.html">lstsq()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/linear_algebra/solve.html">solve()</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../operations/reference/logic/index.html">Logic function</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Logic function</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/logic/allclose.html">allclose()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/logic/equal.html">equal()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/logic/equal-metadata.html">equal_metadata()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/logic/is-contiguous.html">is_contiguous()</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../operations/reference/manipulation/index.html">Manipulation operations</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Manipulation operations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/manipulation/detach.html">detach()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/manipulation/drop-blocks.html">drop_blocks()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/manipulation/join.html">join()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/manipulation/make-contiguous.html">make_contiguous()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/manipulation/manipulate-dimension.html">manipulate dimension</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/manipulation/one-hot.html">one_hot()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/manipulation/remove-gradients.html">remove_gradients()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/manipulation/requires-grad.html">requires_grad()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/manipulation/samples-reduction.html">samples reduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/manipulation/slice.html">slice()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/manipulation/split.html">split()</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../operations/reference/math/index.html">Mathematical functions</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Mathematical functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/math/abs.html">abs()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/math/add.html">add()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/math/divide.html">divide()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/math/multiply.html">multiply()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/math/pow.html">pow()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/math/subtract.html">subtract()</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../operations/reference/set/index.html">Set operations</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Set operations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/set/unique_metadata.html">unique_metadata()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../operations/reference/set/sort.html">sort()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../operations/reference/checks.html">Checks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../operations/CHANGELOG.html">Changelog</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../torch/index.html">TorchScript backend</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of TorchScript backend</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../torch/reference/index.html">API reference</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../torch/reference/tensor.html">TensorMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../torch/reference/block.html">TensorBlock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../torch/reference/labels.html">Labels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../torch/reference/serialization.html">Serialization</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../torch/reference/cxx/index.html">TorchScript C++ API reference</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of TorchScript C++ API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../torch/reference/cxx/tensor.html">TensorMap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../torch/reference/cxx/block.html">TensorBlock</a></li>
<li class="toctree-l4"><a class="reference internal" href="../torch/reference/cxx/labels.html">Labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../torch/reference/cxx/miscellaneous.html">Miscellaneous</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../torch/CHANGELOG.html">Changelog</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../learn/index.html">Learning utilities</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Learning utilities</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../learn/reference/index.html">API reference</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../learn/reference/data/index.html">Data utilites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../learn/reference/nn/index.html">Neural Network</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../examples/learn/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/learn/1-dataset-dataloader.html">Datasets and data loaders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/learn/2-indexed-dataset.html">Using IndexedDataset</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../learn/CHANGELOG.html">Changelog</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../atomistic/index.html">Atomistic applications</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Atomistic applications</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../atomistic/overview.html">Overview</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../atomistic/reference/index.html">API reference</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../atomistic/reference/systems.html">Systems</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../atomistic/reference/models/index.html">Models</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../atomistic/reference/models/export.html">Exporting models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../atomistic/reference/models/metadata.html">Information about models</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../atomistic/reference/ase.html">Atomic Simulation Environment (ASE) integration</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../atomistic/reference/cxx/index.html">C++ API reference</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of C++ API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../atomistic/reference/cxx/systems.html">Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../atomistic/reference/cxx/models.html">Models</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../atomistic/outputs.html">Standard model outputs</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../examples/atomistic/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/atomistic/1-export-atomistic-model.html">Exporting a model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/atomistic/2-running-ase-md.html">Running Molecular Dynamics with ASE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/atomistic/3-atomistic-model-with-nl.html">Creating models that use neighbor lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/atomistic/4-profiling.html">Profiling your models</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../devdoc/index.html">Developer documentation</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Developer documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../devdoc/get-started.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devdoc/architecture.html">Code organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devdoc/versions.html">Version number management</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/core/overview.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="overview">
<span id="core-classes-overview"></span><h1>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h1>
<p>This page presents the core classes of metatensor from the ground-up in a
somewhat abstract way, without being tied to any programming language API
specifics. If you prefer to read concrete examples and tutorials, you should
start with our <a class="reference internal" href="../examples/core/1-first-steps.html#core-tutorial-first-steps"><span class="std std-ref">first steps</span></a> tutorial instead!</p>
<section id="tensormap">
<span id="concept-tensormap"></span><h2>TensorMap<a class="headerlink" href="#tensormap" title="Link to this heading">¶</a></h2>
<p>The core type of metatensor is the <a class="reference internal" href="reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code></a>: a high dimensional
block-sparse tensor containing both data and metadata. A TensorMap contains a
list of blocks (represented as <a class="reference internal" href="#concept-tensorblock"><span class="std std-ref">TensorBlock</span></a>), each associated with
a key; and the set of all keys is stored in a <a class="reference internal" href="#concept-labels"><span class="std std-ref">Labels</span></a> object. Both
these building block for <code class="docutils literal notranslate"><span class="pre">TensorMap</span></code> are explained in more details below.</p>
<p>The keys can contain multiple dimensions (in the illustration below we have two
dimensions named <code class="docutils literal notranslate"><span class="pre">key_1</span></code> and <code class="docutils literal notranslate"><span class="pre">key_2</span></code>), and each entry in the keys has one
integer value for each dimension. Here for example, the first block is
associated with <code class="docutils literal notranslate"><span class="pre">key_1</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">key_2</span> <span class="pre">=</span> <span class="pre">0</span></code>, while the second block is
associated with <code class="docutils literal notranslate"><span class="pre">key_1</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">key_2</span> <span class="pre">=</span> <span class="pre">1</span></code>, and so on.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/TensorMap.svg"><img alt="../_images/TensorMap.svg" src="../_images/TensorMap.svg" style="width: 600px;" />
</a>
<figcaption>
<p><span class="caption-text">Illustration of a metatensor TensorMap object, made of a set of keys and
associated <a class="reference internal" href="#concept-tensorblock"><span class="std std-ref">TensorBlock</span></a>.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Different key dimensions can have different purposes, but some typical keys
dimensions you’ll encounter when working with atomistic data are the following:</p>
<ul class="simple">
<li><p><strong>atomic types dimensions</strong>: when using a one-hot encoding of different
atomic types (or atomic elements) in a structure, the resulting data is
sparse, containing implicit zeros if a given type is not present in a
structure. This is the case of the <code class="docutils literal notranslate"><span class="pre">center_type</span></code> and various
<code class="docutils literal notranslate"><span class="pre">neighbor_type</span></code> key dimensions produced by <a class="reference external" href="https://github.com/Luthaf/rascaline/">rascaline</a>.</p></li>
<li><p><strong>symmetry markers</strong>: Another use case for metatensor is to store and
manipulate equivariant data, i.e. data that transforms in a known, specific
way when the corresponding atomic structure is transformed. This is typically
used to represent the symmetry property of some data with respect to
rotations, by decomposing the properties of interest on a basis of spherical
harmonics. When handling this kind of data, it is convenient to store and
manipulate the data corresponding to different spherical harmonics (or
generally different irreducible representations of the symmetry group)
separately. This is the case of the <code class="docutils literal notranslate"><span class="pre">o3_lambda</span></code> key dimension produced by
<a class="reference external" href="https://github.com/Luthaf/rascaline/">rascaline</a>: different blocks will contain the <span class="math notranslate nohighlight">\(\lambda = 1\)</span> and
<span class="math notranslate nohighlight">\(\lambda = 2\)</span> parts of an equivariant representation.</p></li>
</ul>
</section>
<section id="labels">
<span id="concept-labels"></span><h2>Labels<a class="headerlink" href="#labels" title="Link to this heading">¶</a></h2>
<p>A fundamental part of metatensor is to carry simultaneously the data used in
machine learning and the associated metadata. The first kind of metadata we
encountered was the keys of a <a class="reference internal" href="reference/python/tensor.html#metatensor.TensorMap" title="metatensor.TensorMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorMap</span></code></a>, stored as an instance of
the <a class="reference internal" href="reference/python/labels.html#metatensor.Labels" title="metatensor.Labels"><code class="xref py py-class docutils literal notranslate"><span class="pre">Labels</span></code></a> class. This class is also used to store all other
metadata in metatensor, i.e. all the metadata associated with a given
<a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a>.</p>
<figure class="align-center" id="id2">
<span id="fig-labels"></span><a class="reference internal image-reference" href="../_images/Labels.svg"><img alt="../_images/Labels.svg" src="../_images/Labels.svg" style="width: 600px;" />
</a>
<figcaption>
<p><span class="caption-text">Illustration of two different <a class="reference internal" href="reference/python/labels.html#metatensor.Labels" title="metatensor.Labels"><code class="xref py py-class docutils literal notranslate"><span class="pre">Labels</span></code></a> instances, corresponding to
potential <em>samples</em> (green, on the left) and <em>properties</em> (red, on the
right) of a <a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a>.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>A set of <a class="reference internal" href="reference/python/labels.html#metatensor.Labels" title="metatensor.Labels"><code class="xref py py-class docutils literal notranslate"><span class="pre">Labels</span></code></a> can be seen as a two dimensional array of integers,
where each row corresponds to an entry in the data, and each column is a
<em>dimension</em>, which is named. For example, in the illustration above, the set of
Labels on the left has two dimensions (<code class="docutils literal notranslate"><span class="pre">structure</span></code> and <code class="docutils literal notranslate"><span class="pre">center</span></code>), and 10
entries (10 rows); while the Labels on the right has four dimensions and 8
entries. Depending on the language you use, <a class="reference internal" href="reference/python/labels.html#metatensor.Labels" title="metatensor.Labels"><code class="xref py py-class docutils literal notranslate"><span class="pre">Labels</span></code></a> entries and
dimensions’ names can be accessed and manipulated in different ways, please
refer to the corresponding <a class="reference internal" href="reference/python/index.html#python-api-core"><span class="std std-ref">API documentation</span></a> for
more information.</p>
</section>
<section id="tensorblock">
<span id="concept-tensorblock"></span><h2>TensorBlock<a class="headerlink" href="#tensorblock" title="Link to this heading">¶</a></h2>
<p>The final core object of metatensor is the <a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a>, containing a
dense array of data and metadata describing the different axes of this array.
The simplest possible TensorBlock is represented below, and contains three things:</p>
<ul class="simple">
<li><p>a 2-dimensional <strong>data</strong> array;</p></li>
<li><p>metadata describing the rows of this array, called <strong>samples</strong> and stored as a
set of <a class="reference internal" href="reference/python/labels.html#metatensor.Labels" title="metatensor.Labels"><code class="xref py py-class docutils literal notranslate"><span class="pre">Labels</span></code></a>;</p></li>
<li><p>metadata describing the columns of this array, called <strong>properties</strong>, also
stored as a set of <a class="reference internal" href="reference/python/labels.html#metatensor.Labels" title="metatensor.Labels"><code class="xref py py-class docutils literal notranslate"><span class="pre">Labels</span></code></a>.</p></li>
</ul>
<p>The samples store information about <strong>what objects</strong> the data represents, while
properties store information about <strong>how</strong> these objects are represented. Taking
a couple of examples for clarity:</p>
<ul class="simple">
<li><p>if we are storing the energy of a list of systems in a TensorBlock, the
samples would contain only a single <code class="docutils literal notranslate"><span class="pre">&quot;system&quot;</span></code> dimension, and multiple
entries — one per structure — going from 0 to <code class="docutils literal notranslate"><span class="pre">len(systems)</span></code>. The
properties would contain a single <code class="docutils literal notranslate"><span class="pre">&quot;energy&quot;</span></code> dimension with a single entry,
which value does not carry information;</p></li>
<li><p>if we are storing increasing powers of the bond lengths between pairs of atom
in a structure (<span class="math notranslate nohighlight">\((r_{ij})^k\)</span> for <span class="math notranslate nohighlight">\(k \in [1, n]\)</span>), the samples
would contain the index of the <code class="docutils literal notranslate"><span class="pre">&quot;first_atom&quot;</span></code> (<span class="math notranslate nohighlight">\(i\)</span>) and the
<code class="docutils literal notranslate"><span class="pre">&quot;second_atom&quot;</span></code> (<span class="math notranslate nohighlight">\(j\)</span>); while the properties would contain the value of
<code class="docutils literal notranslate"><span class="pre">&quot;k&quot;</span></code>. The data array would contain the values of <span class="math notranslate nohighlight">\((r_{ij})^k\)</span>.</p></li>
<li><p>if we are storing an atom-centered machine learning representation, the
samples would contain the index of the atom <code class="docutils literal notranslate"><span class="pre">&quot;atom&quot;</span></code> and the index of the
corresponding <code class="docutils literal notranslate"><span class="pre">&quot;system&quot;</span></code>; while the properties would contain information
about the e.g. the basis functions used to define the representation. The
<a class="reference internal" href="#fig-labels"><span class="std std-ref">Labels figure</span></a> above contains an example of samples and
properties that one would find in machine learning representation.</p></li>
</ul>
<p>In general, for a 2-dimensional data array, the value at index <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code> is
described by the <code class="docutils literal notranslate"><span class="pre">i</span></code><sup>th</sup> entry of the samples and the
<code class="docutils literal notranslate"><span class="pre">j</span></code><sup>th</sup> entry of the properties.</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/TensorBlock-Basic.svg"><img alt="../_images/TensorBlock-Basic.svg" src="../_images/TensorBlock-Basic.svg" style="width: 300px;" />
</a>
<figcaption>
<p><span class="caption-text">Illustration of the simplest possible <a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a>: a two
dimensional data array, and two <a class="reference internal" href="reference/python/labels.html#metatensor.Labels" title="metatensor.Labels"><code class="xref py py-class docutils literal notranslate"><span class="pre">Labels</span></code></a> describing these two
axis. The metadata associated with the first axis (rows) describes
<strong>samples</strong>, while the metadata associated with the second axis (columns)
describes <strong>properties</strong>.</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>In addition to all this metadata, metatensor also carries around some data. This
data can be stored in various arrays types, all integrated with metatensor.
Metatensor then manipulate these arrays in an opaque way, without knowing what’s
inside. This allows to integrate metatensor with multiple third-party libraries
and ecosystems, for example having the data live on GPU, or using memory-mapped
data arrays.</p>
<div class="admonition-advanced-functionalities-integrating-new-array-types-with-metatensor admonition">
<p class="admonition-title">Advanced functionalities: integrating new array types with metatensor</p>
<p>Currently, the following array types are integrated with metatensor:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.ndarray.html">Numpy’s ndarray</a> from Python,</p></li>
<li><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html">PyTorch’s Tensor</a> from Python and C++, including full support for
autograd and different device (data living on CPU memory, GPU memory, …),</p></li>
<li><p><a class="reference external" href="https://docs.rs/ndarray/">Rust’s ndarray</a> from Rust, more specifically <code class="docutils literal notranslate"><span class="pre">ndarray::ArrayD&lt;f64&gt;</span></code>,</p></li>
<li><p>A very bare-bone N-dimensional array in metatensor C++ API:
<a class="reference internal" href="reference/cxx/data.html#_CPPv4N10metatensor15SimpleDataArrayE" title="metatensor::SimpleDataArray"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">metatensor::SimpleDataArray</span></code></a></p></li>
</ul>
<p>It is possible to integrate new array types with metatensor, look into the
<a class="reference internal" href="reference/python/data.html#metatensor.data.register_external_data_wrapper" title="metatensor.data.register_external_data_wrapper"><code class="xref py py-func docutils literal notranslate"><span class="pre">metatensor.data.register_external_data_wrapper()</span></code></a> function in Python, the
<a class="reference internal" href="reference/c/data.html#c.mts_array_t" title="mts_array_t"><code class="xref c c-struct docutils literal notranslate"><span class="pre">mts_array_t</span></code></a> struct in C, the <a class="reference internal" href="reference/cxx/data.html#_CPPv4N10metatensor13DataArrayBaseE" title="metatensor::DataArrayBase"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">metatensor::DataArrayBase</span></code></a>
abstract base class in C++, and the <a class="reference external" href="../reference/rust/metatensor/trait.Array.html">metatensor::Array</a> trait in Rust.</p>
</div>
<section id="gradients">
<h3>Gradients<a class="headerlink" href="#gradients" title="Link to this heading">¶</a></h3>
<p>In addition to storing data and metadata together, a <a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a> can
also store values and gradients together. The gradients are stored in another
<a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a>, associated with a <strong>parameter</strong> name, describing with
respect to <strong>what</strong> the gradients are taken. Regarding metadata, the gradient
properties always match the values properties; while the gradient sample are
different from the value samples. The gradient samples contains both what a
given row in the data is the gradient <strong>of</strong>, and <strong>with respect to</strong> what the
gradient is taken. As illustrated below, multiple gradient rows can be gradients
of the same values row, but with respect to different things (here the positions
of different particles in the system).</p>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../_images/TensorBlock-Gradients.svg"><img alt="../_images/TensorBlock-Gradients.svg" src="../_images/TensorBlock-Gradients.svg" style="width: 550px;" />
</a>
<figcaption>
<p><span class="caption-text">Illustration of gradients stored inside a <a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a>.</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="components">
<h3>Components<a class="headerlink" href="#components" title="Link to this heading">¶</a></h3>
<p>There is one more thing <a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a> can contain. When working with
vectorial data, we also handle vector <strong>components</strong> in both data and metadata.
In its most generic form, a <a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a> contains a
<span class="math notranslate nohighlight">\(N\)</span>-dimensional data array (with <span class="math notranslate nohighlight">\(N \geqslant 2\)</span>), and <span class="math notranslate nohighlight">\(N\)</span> set
of <a class="reference internal" href="reference/python/labels.html#metatensor.Labels" title="metatensor.Labels"><code class="xref py py-class docutils literal notranslate"><span class="pre">Labels</span></code></a>. The first Labels describe the <em>samples</em>, the last Labels
describe the <em>properties</em>, and all the remaining Labels describe vectorial
<strong>components</strong> (matching all remaining axes of the data array, from the second
to one-before-last).</p>
<p>For example, gradients with respect to positions are actually a bit more complex
than the illustration above. They always contain a supplementary axis in the
data for the <span class="math notranslate nohighlight">\(x/y/z\)</span> direction of the gradient, associated with a
<strong>component</strong> <a class="reference internal" href="reference/python/labels.html#metatensor.Labels" title="metatensor.Labels"><code class="xref py py-class docutils literal notranslate"><span class="pre">Labels</span></code></a>. Getting back to the example where we store
energy in the <a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a> values, the gradient (i.e. the negative of
the forces) samples describe with respect to which atom position we are taking
gradient, and the component <a class="reference internal" href="reference/python/labels.html#metatensor.Labels" title="metatensor.Labels"><code class="xref py py-class docutils literal notranslate"><span class="pre">Labels</span></code></a> allow to find the <span class="math notranslate nohighlight">\(x/y/z\)</span>
component of the forces.</p>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../_images/TensorBlock-Components.svg"><img alt="../_images/TensorBlock-Components.svg" src="../_images/TensorBlock-Components.svg" style="width: 400px;" />
</a>
<figcaption>
<p><span class="caption-text">Illustration of a <a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a> containing <strong>components</strong> as an
extra set of metadata to describe supplementary axes of the data array.</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Another use-case for components is the storage of equivariant data, where a
given irreducible representation might have multiple elements. For example, when
handling spherical harmonics (which are the irreducible representation of the
<a class="reference external" href="https://en.wikipedia.org/wiki/3D_rotation_group">group of 3D rotations</a> <span class="math notranslate nohighlight">\(SO(3)\)</span>), all the spherical harmonics
<span class="math notranslate nohighlight">\(Y_\lambda^\mu\)</span> with the same angular momentum <span class="math notranslate nohighlight">\(\lambda\)</span> and
corresponding <span class="math notranslate nohighlight">\(\mu\)</span> should be considered simultaneously: the different
<span class="math notranslate nohighlight">\(\mu\)</span> are <strong>components</strong> of a single irreducible representation.</p>
<p>When handling the gradients of equivariant data, we quickly realize that we
might need more than one component in a given <a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a>. Gradients
with respect to positions of an equivariant representation based on spherical
harmonics will need both the gradient direction <span class="math notranslate nohighlight">\(x/y/z\)</span> and the spherical
harmonics <span class="math notranslate nohighlight">\(m\)</span> as components. This impacts metadata associated with
<a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a> in two ways:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a> can have an arbitrary number of components associated
with the values, which will always occur “<em>in between</em>” samples and properties
metadata;</p></li>
<li><p>when values in a <a class="reference internal" href="reference/python/block.html#metatensor.TensorBlock" title="metatensor.TensorBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorBlock</span></code></a> have components, and gradient with
respect to some parameter would add more components, the resulting gradient
components will contain first the new, gradient-specific components, and then
all of the components already present in the values.</p></li>
</ul>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="reference/python/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Python API reference</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Core classes</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Guillaume Fraux, Davide Tisi, Philip Loche, Joseph W. Abbott, Jigyasa Nigam, Chiheb Ben Mahmoud
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Overview</a><ul>
<li><a class="reference internal" href="#tensormap">TensorMap</a></li>
<li><a class="reference internal" href="#labels">Labels</a></li>
<li><a class="reference internal" href="#tensorblock">TensorBlock</a><ul>
<li><a class="reference internal" href="#gradients">Gradients</a></li>
<li><a class="reference internal" href="#components">Components</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/toggleprompt.js?v=5801b3bb"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/custom.js?v=4b1677b9"></script>
    <script data-domain="docs.metatensor.org" defer="defer" src="https://plausible.io/js/script.js"></script>
    </body>
</html>